"# --2024--hkw" 
## 📖 项目概述及工作内容

---

### 项目概述
根据2025年发布的物流创意赛赛题，作品“凌霄”电控部分采用多硬件控制实现多线程的方式（确实存在一些不稳定因素，建议采用软件多线程），由前部分夹取装置，水平滑台，机械臂及车轮几部分构成，并由主控（general_control）进行整体逻辑运行与状态监视

---

### 本人主要负责

1.  **主控对于识别到信息的处理及执行逻辑**
    * 获取到货箱及摆放区域位置后通过计算获取执行搬运顺序，实现对普通箱子及孤儿箱子的分别处理。
    * 编写状态机逻辑，优化每一步执行顺序及合理并行，减少耗时。
    * 调节并控制其他各分控的执行参数，提高运行精确度。

2.  **核心分控处理**
    * #### front:
      对前部分夹取装置的控制部分，使用了大疆2006电机及菲特舵机负责前部分的夹取与提升
    * #### wheel:
      对车轮电机及激光测距进行控制，使用位置，速度双环pid控制，以激光测距反馈的数据作为位置返馈值，控制速度环的目标值，考虑到实际机械结构的稳定性及结构强度，进行了多级速度规划，采用滤波等处理手段通过修改不同滤波参数调节车轮响应速度及速度变化的平稳性，设置不同次数的幂函数曲线拟合车轮启动及刹车状态，减少轨道抖动及对机械结构的损耗。
    * #### horizon:
      对水平滑台位置进行控制，同样使用了大疆2006电机（需要在启动前预先确定初始位置）

3.  **通信协议**
    * 使用了串口uart协议进行数据的发送及接收，从主控发送命令，在分控提前设置好接收处理逻辑，检测到正确的首位字符即读取后面的数字字符并转为double变量存储及执行，执行后清空当前目标值及寄存器，等待下一次读取（部分分控可以同时接收不同指令同时执行，如front分控），发送返回数据给主控作为标志位计数，满足主控状态机条件即更新状态

---

遇到问题举例：
* 1.校赛前云台使用25kg·cm的舵机，由于扭矩不够，旋转时出现明显超调，损坏减速箱，并且有明显自由角无法克服，精确度无法满足要求，后期换用小米电机响应能力好很多，但本人只参与了前期小米电机调整，后期改由他人负责。
* 2.主控状态机有时存在突然卡住的情况，由于常卡在同一个位置，本人将该分控的信息回传删除，改由主控延时处理，成效显著，后来发现其它分控存在接收数据乱码的情况，考虑到主控接收误传信号的概率远低于接收到错误信号的概率，故删除了回传信息处理部分，监测到串口信号即进中断。
* 3.车轮响应速度问题：两侧车轮响应速度不一致，经波形监测发现远离控制端的一侧车轮反馈值抖动剧烈，另一侧抖动较小，经分别设置不同pid参数后近控制端车轮反馈值更加平稳，远端几乎无变化，后尝试改线性变速为曲线变速，增加对两端速度反馈值的滤波处理，并分别赋不同滤波参数，远端抖动才有变缓趋势，但滤波处理过强也会导致整体响应速度变慢，可能存在响应不及时情况，故选择了两个较为合适的参数赋值给两边电机（由于更换了电机仍然有这个问题，考虑不是电机本身的原因，信号传输问题可能性更大一些）
* 4.机械臂夹爪舵机经常性抽搐问题：经学长检查与指导，发现是步进电机驱动器的对外影响过于明显，为降低不确定性因素影响，将步进电机换成小米电机，舵机抖动问题不再发生。
* 5.其它诸多零散问题不再一一赘述，只列举几个典型问题（因为问题实在是太多了）

---
